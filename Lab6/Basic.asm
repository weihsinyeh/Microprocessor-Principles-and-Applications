LIST p=18f4520
    #include<p18f4520.inc>
	CONFIG OSC = INTIO67 ; 1 MHZ
	CONFIG WDT = OFF
	CONFIG LVP = OFF
	
	L1	EQU 0x14
	L2	EQU 0x15
	org 0x00
	
; Total 2 + (2 + 7 * num1 + 2) * num2 cycles = C
; num1 = 200, num2 = 180, C = 252360
; Total delay ~= C/1M = 0.25s
DELAY macro num1, num2 
    local LOOP1 
    local LOOP2
    MOVLW num2
    MOVWF L2
    LOOP2:
	MOVLW num1
	MOVWF L1
    LOOP1:
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	DECFSZ L1, 1
	BRA LOOP1
	DECFSZ L2, 1
	BRA LOOP2
endm

	
start:
int:
; let pin can receive digital signal 
MOVLW 0x0f
MOVWF ADCON1
CLRF PORTB
BSF TRISB, 0 ;B?0?input
CLRF LATA    ;port A 
BCF TRISA, 0 ;?port A?bit 0 ??output???clear
BCF TRISA, 1 ;?port A?bit 1 ??output???clear   
BCF TRISA, 2 ;?port A?bit 2 ??output???clear
BCF TRISA, 3 ;?port A?bit 3 ??output???clear
BCF PORTB, 0 ;?port B?bit 0 ????
CLRF 0x00    ;???1?
; ckeck button
check_process:
   BTFSC PORTB, 0 ;??port B???0?
   BRA check_process
   BRA lightup
lightup:
    check1: MOVLW 0x00  ;?0??WREG
	   CPFSEQ 0x00  ;?0x?0???????????????
	    GOTO check2 ;??????????
	   BTG LATA, 0  ;?port A ??0?bit toggle 
	   INCF 0x00    ;??0x00???????????
	   BCF PORTB, 0, 0 ;?port B ??????????????????
	   GOTO lastlightup ;?????
	   
    check2: MOVLW 0x01  ;?1??WREG
	   CPFSEQ 0x00   ;?[0x00]???0x01??????????????????
	    GOTO check3 ;????????????
	   BTG LATA, 1   ;?port A ??1?bit toggle (???????)
	   INCF 0x00     ;??0x00???????????
	   BCF PORTB, 0, 0 ;?port B ??????????????????
	   GOTO lastlightup
	    
   check3: MOVLW 0x02  ;?2??WREG
	   CPFSEQ 0x00  ;?[0x00]???0x02??????????????????
	    GOTO check4 ;???????????
	   BTG LATA, 2   ;?port A??2?bit toggle (???????)
	   INCF 0x00     ;??0x00???????????
	   BCF PORTB, 0, 0;?port B ??????????????????
	   GOTO lastlightup
	   
  check4: MOVLW 0x03  ;?3??WREG
           CPFSEQ 0x00 ;?[0x00]???0x03??????????????????
	    GOTO nolight;?????4????????????????
	   BTG LATA, 3  ;?port A??3?bit toggle (???????)
	   INCF 0x00    ;??0x00???????????
	   BCF PORTB, 0, 0 ;?port B ????????????????
	   GOTO lastlightup
   nolight:       
	    BTG LATA, 0 ;????
	    BTG LATA, 1 ;????
	    BTG LATA, 2 ;????
	    BTG LATA, 3 ;????
	    CLRF 0x00
    lastlightup:
	DELAY d'50', d'45' ;delay 0.25s
	BRA check_process
end


