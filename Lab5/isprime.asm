#include "xc.inc"
    GLOBAL _isprime
    PSECT mytext , local, class = CODE , reloc = 2;
setFF:
    MOVLW 0xFF
    MOVWF 0x12
    RETURN
set01:
    MOVLW 0x01
    MOVWF 0x12
    RETURN
; ?????????    
divise:                          
    MOVFF 0x001,0x011         ; ???????[0x001]????[0x011]
    WHILE:      
        MOVF 0x010,W          ; ????????WREG
        CPFSGT 0x011          ; ??????FILE[0x011]  > ?????WREG[0x010]
	    GOTO endWHILE     ; ??????FILE[0x011]  <=(??"??") ?????WREG[0x010]
	;FILE > WREG
	MOVF 0x010,W          ; ??????[0x010]??WREG
	SUBWF 0x011,F         ; ?????????FILE[0x011] ???????WREG ??File?
	GOTO WHILE
 
    endWHILE:                  ;????????????????????? ?????
    
	MOVF 0x010,W           ; ????????WREG
	CPFSEQ 0x011            ;???????File ??
	    rcall set01         ; ????????(???????????)
	    
	MOVF 0x010,W          ;???????
	CPFSEQ 0x011          ; ????????WREG???????File ??
	    GOTO endDivise    ;??????????set01?????(???????????????)
	    
	rcall setFF              ;????????????? ?? ?? ??????????(??????????????)
	
    endDivise:                   ;????
	NOP
RETURN
; | 0x001 ? LATD ???????????  |
; | 0x10 ??????????????     |  0x11 (????????????) | 0x12 ????????????????????????
_isprime:                        ;???????
    MOVFF 0x001 , LATD        ;?????LATD
               
    MOVLW 0x01               ;?1????1???????????????????????
    MOVWF 0x010              ;??0x10 [0x10] = 0x01 
    MOVLW 0x01               ;[0x12] = 0x01
    MOVWF 0x12
    
    Loop:                  
        INCF 0x010             ;????????
	MOVF LATD,W           ;?????????WREG
	CPFSLT 0x010           ;??????? < ?????? (????????1???)????? (??????)
	    GOTO endisprime   ;?????????
	
	rcall divise             ;????????????????????
	
	MOVLW 0x01           ;??????
	CPFSEQ 0x12            ;??????????0x12(0x01?????0xFF????)?0x01????????????
	    GOTO endisprime    ;??????????
	GOTO Loop              ;??:0x01 ?????????? ?????????????????
	
    endisprime:                  ;?????0x001 ??
	MOVFF 0x12,0x001     ;?????0x001
RETURN