#include "xc.inc"
    GLOBAL _mypow
    PSECT mytext , local, class = CODE , reloc = 2

 MUL:
    ;??high byte ??
    MOVFF 0x02,0x21 ;?high byte ??0x21
    MOVFF 0x11,0x22 ;??(??)?????? (??) ??0x22
    
    MOVF   0x21,W   ;?high byte????WREG
    MULWF 0x22     ;?WREG??? (??) ??
    MOVFF PRODL,0x02 ;????lowbyte??0x02 (high byte)???????high byte??????????16bits

    MOVFF 0x01,0x21 ;?low byte??0x21
    MOVFF 0x11,0x22 ;??(??)?????? (??) ??0x22
    
    MOVF 0x21,W     ;?low byte????WREG
    MULWF 0x22     ;??(??)?????? (??) ??0x22

    MOVFF PRODL,0x01 ;????low byte??0x01
    MOVF PRODH,W     ;????high byte ??WREG
    ADDWF 0x02      ;??high byte ?? ??high byte???  
    RETURN
   
;????????
ADJUST:             
    MOVLW 0x01     ;?1?????AND ??????????
    ANDWF 0x14,F   ;????0x14
    MOVLB 0x01     ;??0x14????0x01????
    CPFSEQ 0x14     ;??????????(??)
	GOTO afterAdjust ;???(??)??????
	
    COMF 0x02       ;?hight byte?1??
    NEGF 0x01       ;?low byte?2??
    
    MOVLW 0x00     ;??low byte???0
    CPFSEQ 0x01     ;??0??????
	GOTO afterAdjust ;??0
	
    ;low byte ?0 ???? XXXX0000 (2's)-> YYYY0000???????2??
    INCF 0x02    ;?????
    GOTO afterAdjust
	
;0x00 () | 0x01 (low byte)     | 0x02 (high byte) | 0x03
;0x10 () | 0x11 (??)         | 0x12 (??)       | 0x13 (??) | 0x14 (???????????)
;0x20 () | 0x21 (????byte) | 0x22 (???????)       |
 _mypow:
    MOVFF 0x03,0x12 ;????????0x12  (???) 
    MOVFF 0x03,0x14 ;?(??)?????? (???)
    MOVFF 0x01,0x11 ;????????0x11 (??)
    MOVFF 0x01,0x13 ;?(??)?????? (??)
    
    BTFSC 0x11,7     ;???????(??)?????
	NEGF 0x11    ;???????????
    
    CLRF 0x03        
    CLRF 0x02        ;????highbyte???
    CLRF 0x01        ;????lowbyte???
    
    MOVLW 0x01      ;[0x01]??1
    MOVWF 0x01      ;?1?????low byte

LOOP:
    MOVLW 0x00        ;??????? ???(????0)????????pow????
    CPFSGT 0x12;       ;??(???)??0 (??0)??????
	GOTO endMypow  ;?0?????????????1???low byte
    rcall MUL             ;??pow???
    DECF 0x12           ;?(??)???
    GOTO LOOP 
    endMypow:            ;????????????????????
	BTFSC 0x13,7    ;???????????? ????bit ?1
	    rcall ADJUST  ;???????????
    afterAdjust:
	NOP
    RETURN


